<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leafcutter Shiny App • leafcutter</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Leafcutter Shiny App">
<meta property="og:description" content="leafcutter">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">leafcutter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Installation.html">Installation</a>
</li>
<li>
  <a href="../articles/Usage.html">Differential splicing</a>
</li>
<li>
  <a href="../articles/UsageLeafcutterMD.html">Outlier splicing</a>
</li>
<li>
  <a href="../articles/Visualization.html">Visualization</a>
</li>
<li>
  <a href="../articles/sQTL.html">SplicingQTL</a>
</li>
<li>
  <a href="../reference/index.html">R functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/davidaknowles/leafcutter">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Leafcutter Shiny App</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/davidaknowles/leafcutter/blob/master/vignettes/Visualization.Rmd"><code>vignettes/Visualization.Rmd</code></a></small>
      <div class="hidden name"><code>Visualization.Rmd</code></div>

    </div>

    
    
<p>Written by Jack Humphrey, David Knowles &amp; Yang Li</p>
<p>To see an example of the <code>leafcutter</code> shiny app in action without installing anything take a look at <a href="https://leafcutter.shinyapps.io/leafviz/" class="uri">https://leafcutter.shinyapps.io/leafviz/</a>. This shows <code>leafcutter</code> differential splicing results for a comparison of 10 brain vs. 10 heart samples (5 male, 5 female in each group) from <a href="https://www.gtexportal.org/home/">GTEx</a>.</p>
<p>The leafcutter shiny app has been tested on <code>macOS 10.12</code> and <code>Ubuntu 14.04</code>.</p>
<div id="installation" class="section level4">
<h4 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h4>
<p><strong>UPDATE</strong> As of September 2020, LeafViz is now a standalone app. The original version of the app is still within the Leafcutter repository but will eventually be deprecated as all further maintenance and development will be to the standalone version.</p>
<pre><code>## in R:
install.packages("remotes")
remotes::install_github("jackhump/leafviz")

## on the command line:
git clone https://github.com/jackhump/leafviz.git</code></pre>
</div>
<div id="run-example" class="section level4">
<h4 class="hasAnchor">
<a href="#run-example" class="anchor"></a>Run Example</h4>
<p>Once you’ve installed leafviz and downloaded the github repo then you can easily fire up a local shiny app on the same GTEx example data. Navigate into the <code>leafviz</code> directory:</p>
<pre><code>cd leafviz/scripts</code></pre>
<p>Now starting the shiny app should be as easy as</p>
<pre><code>./run_leafviz.R example/Brain_vs_Heart_results.Rdata</code></pre>
<p>You can even leave out the <code>leafviz_example/Brain_vs_Heart_results.Rdata</code> part as this is the default dataset <code>run_leafviz.R</code> will try to use.</p>
</div>
<div id="prerequisites-annotation-data" class="section level4">
<h4 class="hasAnchor">
<a href="#prerequisites-annotation-data" class="anchor"></a>Prerequisites: Annotation data</h4>
<p>The Shiny app includes functionality to label detected introns as annotated or cryptic. To do for a new dataset this an “annotation code” is needed, built from a “Gene Transfer Format” file appropriate for your genome. We provide pre-built annotation codes for hg19 and hg38 which can be downloaded by running</p>
<pre><code>./download_human_annotation_codes.sh</code></pre>
<p>from the <code>leafviz</code> directory. To build a new annotation code requires <code>perl</code>.</p>
<p>This step processes a given GTF to generate lists of exons, introns and splice sites. This step only has to be run once to use a particular GTF file with the app.</p>
<p>The recommended way to do this is</p>
<pre><code>./gtf2leafcutter.pl -o &lt;annotation_code&gt; my_transcriptome.gtf[.gz]</code></pre>
<p><strong>my_transcriptome.gtf</strong> - a gene transfer format file, provided by GENCODE, Ensembl, etc.</p>
<p><strong>annotation_code</strong> - the path or folder name with a base name, eg <code>/path/to/gencode_hg38</code></p>
<p><code>gtf2leafcutter.pl</code> can take in a <code>gzip</code>ped <code>gtf</code> file as long as the file name ends with <code>.gz</code>.</p>
<p>(thanks to <a href="https://pintolab.mssm.edu/">Dalila Pinto</a> for contributing the new script).</p>
<p>This will create:</p>
<pre><code>&lt;annotation_code&gt;_all_introns.bed.gz
&lt;annotation_code&gt;_threeprime.bed.gz
&lt;annotation_code&gt;_fiveprime.bed.gz
&lt;annotation_code&gt;_all_exons.txt.gz</code></pre>
<p>We’ve only tested with the GENCODE human GRCh37/GRCh38 and mouse GTF files. If you have problems with other <code>gtf</code> files please let us know.</p>
</div>
<div id="step-1--prepare-the-leafcutter-differential-splicing-results-for-visualisation" class="section level3">
<h3 class="hasAnchor">
<a href="#step-1--prepare-the-leafcutter-differential-splicing-results-for-visualisation" class="anchor"></a>Step 1. Prepare the LeafCutter differential splicing results for visualisation</h3>
<p>This step annotates each intron in each cluster at a given false discovery rate and generates a single <code>.RData</code> file with everything the shiny app needs to run.</p>
<pre><code>leafcutter/leafviz/prepare_results.R [options] &lt;name&gt;_perind_numers.counts.gz &lt;name&gt;_cluster_significance.txt &lt;name&gt;_effect_sizes.txt annotation_code </code></pre>
<p>** <name>_perind_numers.counts.gz ** The same counts matrix you gave to <code>leafcutter_ds.R</code>. ** <name>_cluster_significance.txt ** The cluster significant table output by <code>leafcutter_ds.R</code>. ** <name>_effect_sizes.txt ** The per junction effect size table output by <code>leafcutter_ds.R</code>. ** annotation_code ** will be something like <code>annotation_codes/gencode_hg19/gencode_hg19</code> (see above)</name></name></name></p>
<p>Options:</p>
<pre><code>    -o OUTPUT, --output=OUTPUT
        The output file that will be created ready for loading by run_leafviz.R [leafviz.RData]

    -m META_DATA_FILE, --meta_data_file=META_DATA_FILE
        The support file used in the differential splicing analysis. Columns should be file name and condition

    -f FDR, --FDR=FDR
        the adjusted p value threshold to use [0.05]

    -c CODE, --code=CODE
        A name for this analysis (will be available in leafviz through the Summary tab). [leafcutter_ds]

    -h, --help
        Show this help message and exit</code></pre>
<p>This will create the Rdata file wherever <code>--output</code> is pointed. The file ‘prepare_example.sh’ shows how this would be done for the example dataset if you wanted to rebuild ‘Brain_vs_Heart_results.Rdata’.</p>
<p>As a concrete example, let’s assume you just ran the example at <a href="./Usage.html">Usage</a> and you’re within the <code>leafcutter/</code> top directory .</p>
<pre><code>cd leafviz/
./prepare_results.R --meta_data_file ../example_data/example_geuvadis/groups_file.txt \
  --code leafcutter ../example_data/testYRIvsEU_perind_numers.counts.gz \
  ../example_data/leafcutter_ds_cluster_significance.txt \
  ../example_data/leafcutter_ds_effect_sizes.txt \
  annotation_codes/gencode_hg19/gencode_hg19 \
  -o testYRIvsEU.RData</code></pre>
<p>should create an <code>testYRIvsEU.RData</code> file.</p>
</div>
<div id="step-2--visualise-the-results" class="section level3">
<h3 class="hasAnchor">
<a href="#step-2--visualise-the-results" class="anchor"></a>Step 2. Visualise the results</h3>
<p>From the <code>example_data</code> directory.</p>
<pre><code>cd &lt;leafviz repo&gt;/scripts/
./run_leafviz.R testYRIvsEU.RData</code></pre>
<p>This will load in the Rdata object and run the LeafCutter Visualisation App in your browser.</p>
</div>
<div id="features" class="section level3">
<h3 class="hasAnchor">
<a href="#features" class="anchor"></a>Features</h3>
<ul>
<li>Visualisation of significantly changed clusters</li>
</ul>
<div class="figure">
<img src="./cluster_plot_example.png" alt="cluster plot example"><p class="caption">cluster plot example</p>
</div>
<ul>
<li>Visualisation of all clusters discovered in a gene</li>
</ul>
<div class="figure">
<img src="./gene_plot_example.png" alt="gene plot example"><p class="caption">gene plot example</p>
</div>
<ul>
<li><p>PCA plot based on splice junction counts</p></li>
<li><p>All plots can be exported as PDF</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Knowles, Yang Li, Jack Humphrey, Jonathan Pritchard, Garrett Jenkinson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
